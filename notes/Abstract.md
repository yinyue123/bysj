abstract
IPSec VPN is a security standard framework defined by IETF. Its security features (including non-repudiation, anti-replay, data integrity, data reliability) and ease of use are better than PPTP, L2TP, etc. Its security is widely used in industry, commerce and government. Professional Virtual Local Area Network (VPN) gateway equipment has high performance, but its price is expensive and flexibility is poor. While IPSec VPN, which uses the traditional Linux protocol stack of universal servers, is flexible, its performance has reached the bottleneck. Because of its high throughput, forwarding rate and low latency, user-mode protocol stack has been popular among Internet companies and has become a hot research topic. Intel DPDK is one of the excellent user-mode protocol stack development platforms.
Chapter 2 of this paper introduces how DPDK user protocol stack can solve the problems of frequent interruption, data redundancy copy and lock competition of traditional protocol stack. Chapter 3 briefly introduces IKE key exchange, XFRM framework, communication between kernel protocol stack and user protocol stack, and interprocess communication technology of IPSec. Chapter 4 is about the user-state protocol stack
The whole design is explained. Chapter 5 explains the structure of ESP packet, the process of ESP packet and unpacking, SADB and SPDB in detail. The NAT algorithm design, ARP protocol design, checksum algorithm design of user-mode protocol stack are explained in detail. Chapter 6 tests the performance of IPSec VPN program based on DPDK, and proves that IPSec VPN based on DPDK is superior to traditional protocol stack VPN in throughput, forwarding rate and low latency.
Key words: IPSec, VPN, DPDK, user-mode protocol stack, NAT, XFRM, ARP, checksum