摘要
IPSec VPN是IETF定义的安全标准框架，其安全特性(包括不可否认性，反重播性，数据完整性，数据可靠性)和易用性均优于PPTP，L2TP等，其安全性被广泛用于工业，商业，政府。专业虚拟局域网(VPN)网关设备虽然性能高，但其价格昂贵，灵活性差。而使用通用服务器的传统Linux协议栈的IPSec VPN虽然灵活性好，但性能却已经达到了瓶颈。用户态协议栈由于其高吞吐量，转发率和低时延等优点收到各大互联网公司的热捧，成为热门研究话题。其中Intel DPDK是优秀用户态协议栈开发平台之一。
本文第二章介绍了DPDK的用户态协议栈如何解决传统协议栈的频繁中断，数据冗余拷贝，锁竞争等问题。第三章简略介绍了IPSec的IKE密钥交换，XFRM框架，内核协议栈和用户态协议栈通信，进程间通信技术。第四章对用户态协议栈的
设计整体进行了讲解。第五章详细讲解了ESP数据包的结构，ESP封包和解包的过程，安全关联数据库(SADB)，安全策略数据库(SPDB)。并详细讲解了用户态协议栈NAT算法设计，ARP协议设计，校验和算法设计。第六章对基于DPDK的IPSec VPN程序的性能进行了测试，证明基于DPDK的IPSec VPN在吞吐量、转发率和低时延方面优于传统协议栈VPN。
关键字：IPSec，VPN，DPDK，ESP，IKE，用户态协议栈，NAT，XFRM，ARP，校验和